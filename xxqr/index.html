<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Name speichern</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; padding: 20px; }
        input, button { padding: 10px; margin: 5px; }
        .error { color: red; }
    </style>
</head>
<body>

    <h1>Name speichern</h1>

    <form id="nameForm">
        <input type="text" id="nameInput" placeholder="Name eingeben" required>
        <button type="submit">Speichern</button>
    </form>

    <p id="savedName">Lade gespeicherten Namen...</p>
    <p id="errorMessage" class="error"></p>

    <script>
        const supabaseUrl = "https://iwhraktqekgrncqucspx.supabase.co";
        const supabaseKey = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Iml3aHJha3RxZWtncm5jcXVjc3B4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDIwNDY2NzUsImV4cCI6MjA1NzYyMjY3NX0.M7PTaSkoa1phTgZa3Q7uVD3FIHG7C6wLh3Z5vWPCdKQ";
        const supabase = supabase.createClient(supabaseUrl, supabaseKey);

        // Name von der Datenbank laden
        async function fetchName() {
            let { data, error } = await supabase
                .from("users")
                .select("name")
                .order("id", { ascending: false })
                .limit(1)
                .single();

            if (error) {
                document.getElementById("errorMessage").innerText = "Fehler beim Abrufen!";
                console.error(error);
            } else {
                document.getElementById("savedName").innerText = "Gespeicherter Name: " + (data?.name || "Kein Name gespeichert.");
            }
        }

        // Name speichern, wenn das Formular abgeschickt wird
        document.getElementById("nameForm").addEventListener("submit", async function (event) {
            event.preventDefault();
            let name = document.getElementById("nameInput").value.trim();

            if (name === "") return;

            let { data, error } = await supabase
                .from("users")
                .insert([{ name }]);

            if (error) {
                document.getElementById("errorMessage").innerText = "Fehler beim Speichern!";
                console.error(error);
            } else {
                document.getElementById("savedName").innerText = "Gespeicherter Name: " + data[0].name;
                document.getElementById("nameInput").value = "";
                document.getElementById("errorMessage").innerText = "";
            }
        });

        fetchName();
    </script>

</body>
</html>


</body>
</html>

